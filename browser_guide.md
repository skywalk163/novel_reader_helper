# 浏览器功能使用指南

## 概述

小说阅读神器内置了强大的浏览器功能，可以直接浏览小说网站，提取网页内容，识别图片中的文字，并进行智能分析和总结。本指南将详细介绍如何使用这些功能。

## 功能特性

- 🌐 **内置浏览器**：基于PyQt5 WebEngine的完整浏览器体验
- 📄 **智能内容提取**：自动识别和提取网页中的小说内容
- 🖼️ **图片OCR识别**：识别网页中图片内的文字内容
- 🤖 **AI智能分析**：对提取的内容进行关键词提取和智能总结
- 💾 **内容保存**：支持将分析结果保存为文件

## 快速开始

### 1. 打开浏览器

1. 在主界面中点击 **🌐 打开浏览器** 按钮
2. 浏览器窗口将自动打开并加载默认主页（起点中文网）
3. 按钮文字将变为 **🌐 关闭浏览器**，再次点击可关闭浏览器

### 2. 网站导航

#### 地址栏导航
- 在地址栏中直接输入网址，如：`www.qidian.com`
- 输入搜索关键词，系统将自动使用百度搜索
- 按回车键或点击 **转到** 按钮进行导航

#### 快捷网站按钮
工具栏提供了主要小说网站的快捷访问：
- **起点**：起点中文网（https://www.qidian.com）
- **纵横**：纵横中文网（https://www.zongheng.com）
- **17K**：17K小说网（https://www.17k.com）
- **读书**：读书网（https://www.readnovel.com）

#### 浏览器控制
- **← 后退**：返回上一页（Alt+Left）
- **前进 →**：前往下一页（Alt+Right）
- **🔄 刷新**：刷新当前页面（F5）
- **⏹ 停止**：停止页面加载（Esc）
- **🏠 主页**：返回默认主页

## 内容提取功能

### 网页文本提取

1. 浏览到目标网页（如小说章节页面）
2. 点击工具栏中的 **📄 提取内容** 按钮
3. 系统将自动：
   - 分析网页结构
   - 提取主要文本内容
   - 识别章节信息
   - 统计字数
   - 提取图片链接

#### 支持的内容类型
- 小说章节正文
- 网页标题和元信息
- 图片及其描述信息
- 章节导航信息

#### 提取结果格式
```
# 浏览器内容提取 (2024-01-01 10:30:00)

**标题**: 章节标题
**来源**: https://example.com/chapter/123
**字数统计**: 约3000字
**提取方式**: 网页文本提取

========================================

[正文内容...]

========================================
## 图片信息:

### 图片 1:
- URL: https://example.com/image1.jpg
- 描述: 图片描述
- 标题: 图片标题
```

### 图片OCR识别

当网页中包含文字图片时，可以使用OCR功能提取图片中的文字：

1. 确保PaddleOCR服务正在运行（端口5000）
2. 浏览到包含文字图片的网页
3. 点击工具栏中的 **🖼️ 识别图片** 按钮
4. 系统将自动：
   - 扫描页面中的所有图片
   - 下载图片到临时文件
   - 调用OCR服务识别文字
   - 合并识别结果

#### OCR识别流程
1. **图片发现**：扫描页面中的img标签
2. **图片下载**：筛选合适大小的图片进行下载
3. **OCR识别**：调用本地OCR服务识别文字
4. **结果合并**：将识别结果与网页文本合并

#### 识别结果格式
```
# 浏览器内容提取 (2024-01-01 10:30:00)

**标题**: 网页标题
**来源**: https://example.com
**提取方式**: 图像识别

========================================

[网页文本内容...]

========================================
## 图片OCR识别结果:

### 图片 1:
- 来源: https://example.com/image1.jpg
- 识别内容: [OCR识别的文字]
- 可信度: 0.95
```

## AI智能分析

提取内容后，系统会自动询问是否进行AI分析：

### 自动分析功能
- **关键词提取**：使用jieba分词提取重要关键词
- **重要句子识别**：基于关键词权重筛选重要句子
- **内容摘要**：生成章节概要和统计信息
- **阅读时间估算**：根据字数估算阅读时间

### 分析结果示例
```
# 第一章 修真之路

📊 字数统计：约 3000 字
⏱️ 阅读时间：约 6 分钟

🔑 关键词：
  修真、灵气、境界、突破、功法、丹药、师父、弟子

📖 重要内容：
  • 主角踏上修真之路，拜入仙门
  • 获得神秘功法，开始修炼
  • 遇到强敌，经历生死考验
  • 境界突破，实力大增
  • 结识同门师兄弟，建立友谊
```

## 使用技巧

### 1. 内容提取优化

#### 选择合适的页面
- ✅ **推荐**：小说正文页面、章节页面
- ✅ **推荐**：内容丰富的文章页面
- ❌ **不推荐**：导航页面、搜索结果页面
- ❌ **不推荐**：包含大量广告的页面

#### 提取时机
- 等待页面完全加载后再进行提取
- 对于动态加载的内容，可能需要滚动页面后再提取

### 2. OCR识别优化

#### 前置条件检查
```bash
# 检查OCR服务状态
curl http://127.0.0.1:5000/status
```

#### 适合OCR的图片类型
- ✅ 文字清晰的截图
- ✅ 扫描的书页图片
- ✅ 小说章节的图片版本
- ❌ 装饰性图片
- ❌ 过小或模糊的图片

### 3. 性能优化建议

- **批量处理**：一次提取多个章节后再进行分析
- **网络优化**：确保网络连接稳定，避免图片下载失败
- **内存管理**：处理大量内容时建议分批保存结果

## 常见问题与解决方案

### Q1: 浏览器无法打开
**症状**：点击"打开浏览器"按钮后出现错误提示

**解决方案**：
1. 检查PyQt5和PyQtWebEngine是否正确安装：
   ```bash
   pip install PyQt5 PyQtWebEngine
   ```
2. 在某些系统上可能需要安装额外依赖：
   ```bash
   # Windows
   pip install PyQt5-tools
   
   # Linux
   sudo apt-get install python3-pyqt5.qtwebengine
   ```

### Q2: 内容提取失败
**症状**：点击"提取内容"后显示"未能提取到有效内容"

**可能原因及解决方案**：
1. **页面未完全加载**
   - 等待页面加载完成后再尝试
   - 刷新页面后重试

2. **页面结构特殊**
   - 尝试其他相似网站
   - 检查页面是否包含有效文本内容

3. **网络连接问题**
   - 检查网络连接
   - 尝试访问其他网站测试

### Q3: OCR识别无结果
**症状**：点击"识别图片"后显示"未识别出文字"

**解决方案**：
1. **检查OCR服务**：
   ```bash
   # 测试OCR服务是否运行
   curl http://127.0.0.1:5000/status
   ```

2. **启动OCR服务**：
   ```bash
   cd paddleocrapp
   python app.py
   ```

3. **图片质量问题**：
   - 确保页面包含清晰的文字图片
   - 避免处理装饰性或低质量图片

### Q4: 内容过长导致卡顿
**症状**：提取或分析大量内容时程序响应缓慢

**解决方案**：
1. **分段处理**：将长文本分成多个部分处理
2. **保存中间结果**：及时保存已处理的内容
3. **调整配置**：在主界面调整关键词数量和摘要句子数量

### Q5: 浏览器显示异常
**症状**：浏览器窗口显示不正常或无法正常浏览网页

**解决方案**：
1. **重启浏览器**：关闭并重新打开浏览器窗口
2. **清除缓存**：重启整个应用程序
3. **更新依赖**：确保PyQt5和PyQtWebEngine为最新版本

## 高级功能

### 1. 自定义网站支持

如需添加新的小说网站快捷按钮，可以修改`browser.py`文件：

```python
# 在create_toolbar方法中添加新网站
sites = [
    ("起点", "https://www.qidian.com"),
    ("纵横", "https://www.zongheng.com"),
    ("17K", "https://www.17k.com"),
    ("读书", "https://www.readnovel.com"),
    ("新网站", "https://new-site.com"),  # 添加新网站
]
```

### 2. 内容提取规则自定义

可以通过修改`web_extractor.py`来支持特定网站的内容提取：

```python
# 添加特定网站的提取规则
def extract_content(self, html, url=""):
    """根据网站URL选择不同的提取策略"""
    if "special-site.com" in url:
        return self.extract_special_site(html, url)
    else:
        return self.extract_general_content(html, url)
```

### 3. 批量处理脚本

可以编写脚本自动化处理多个页面：

```python
# 示例：批量提取小说章节
urls = [
    "https://example.com/chapter1",
    "https://example.com/chapter2",
    # ... 更多章节URL
]

for url in urls:
    # 1. 导航到URL
    # 2. 提取内容
    # 3. 进行AI分析
    # 4. 保存结果
    pass
```

## 更新日志

### v1.1 (最新版本)
- ✅ 改进了错误处理和用户反馈机制
- ✅ 添加了详细的操作状态显示
- ✅ 优化了OCR识别流程和进度显示
- ✅ 增强了内容提取的稳定性
- ✅ 改进了浏览器窗口关闭检测

### v1.0
- ✅ 基本浏览器功能
- ✅ 网页内容提取
- ✅ 图片OCR识别
- ✅ AI内容分析
- ✅ 结果保存功能

## 技术支持

如果遇到其他问题，请检查以下文件中的详细信息：
- `README.md` - 项目整体介绍
- `USAGE.md` - 基础使用说明
- `INSTALL_GUIDE.md` - 安装指导

或查看错误日志获取更多技术细节。